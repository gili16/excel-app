{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect } from \"react\";\nimport { useAppDispatch } from \"../redux/store\";\nimport { getSession, isValidToken, setAuthorizationHeader } from \"./auth.utils\";\nimport { setInitialize, setUser } from \"../redux/user/user.slice\";\nimport { initCategory } from \"../redux/category/category.thunk\";\nimport { initCompany } from \"../redux/company/company.thunk\";\nimport { initDayPart } from \"../redux/dayPart/dayPart.thunk\";\nimport { initExperience } from \"../redux/experience/experience.thunk\";\nimport { initStatus } from \"../redux/status/status.thunk\";\nimport { initLevel } from \"../redux/level/level.thunk\";\nimport { initViews } from \"../redux/view/view.thunk\";\nimport { useSelector } from \"react-redux\";\nimport { selectUser } from \"../redux/user/user.selector\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function InitializeAuth({\n  children\n}) {\n  _s();\n  const dispatch = useAppDispatch();\n  const user = useSelector(selectUser);\n  useEffect(() => {\n    loadGetSession();\n  }, []);\n  async function loadGetSession() {\n    alert(\"load session\");\n    const authUser = await getSession();\n    if (authUser !== null && authUser !== void 0 && authUser.token && isValidToken(authUser.token)) {\n      dispatch(setUser(authUser.user));\n      setAuthorizationHeader(authUser.token);\n    }\n    if (user.isInitialized === false) {\n      dispatch(initCategory());\n      dispatch(initCompany());\n      dispatch(initDayPart());\n      dispatch(initExperience());\n      dispatch(initStatus());\n      dispatch(initLevel());\n      dispatch(initViews());\n    }\n    dispatch(setInitialize());\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: children\n  }, void 0, false);\n}\n_s(InitializeAuth, \"AQVj0wIu4Hz4tl+W/MzaV73t4o0=\", false, function () {\n  return [useAppDispatch, useSelector];\n});\n_c = InitializeAuth;\nvar _c;\n$RefreshReg$(_c, \"InitializeAuth\");","map":{"version":3,"names":["useEffect","useAppDispatch","getSession","isValidToken","setAuthorizationHeader","setInitialize","setUser","initCategory","initCompany","initDayPart","initExperience","initStatus","initLevel","initViews","useSelector","selectUser","Fragment","_Fragment","jsxDEV","_jsxDEV","InitializeAuth","children","_s","dispatch","user","loadGetSession","alert","authUser","token","isInitialized","_c","$RefreshReg$"],"sources":["C:/Users/landa/Documents/לימודים/תכנות יד/react/my-final-project/src/auth/InitializeAuth.tsx"],"sourcesContent":["import { ReactNode, useEffect } from \"react\"\r\nimport { useAppDispatch } from \"../redux/store\"\r\nimport { AuthUser } from \"../types/user.types\"\r\nimport { getSession, isValidToken, setAuthorizationHeader } from \"./auth.utils\"\r\nimport { setInitialize, setUser } from \"../redux/user/user.slice\"\r\nimport { initCategory } from \"../redux/category/category.thunk\"\r\nimport { initCompany } from \"../redux/company/company.thunk\"\r\nimport { initDayPart } from \"../redux/dayPart/dayPart.thunk\"\r\nimport { initExperience } from \"../redux/experience/experience.thunk\"\r\nimport { init } from \"../redux/view/view.slice\"\r\nimport { initStatus } from \"../redux/status/status.thunk\"\r\nimport { initLevel } from \"../redux/level/level.thunk\"\r\nimport { initViews } from \"../redux/view/view.thunk\"\r\nimport { useSelector } from \"react-redux\"\r\nimport { selectUser } from \"../redux/user/user.selector\"\r\n\r\ntype Props = {\r\n    children: ReactNode\r\n}\r\n\r\nexport default function InitializeAuth({ children }: Props) {\r\n    const dispatch = useAppDispatch();\r\n    const user=useSelector(selectUser)\r\n    useEffect(() => {\r\n        loadGetSession();\r\n\r\n    }, [])\r\n    async function loadGetSession() {\r\n        alert(\"load session\")\r\n        const authUser: AuthUser | null = await getSession()\r\n            if (authUser?.token && isValidToken(authUser.token)) {\r\n                dispatch(setUser(authUser.user))\r\n                setAuthorizationHeader(authUser.token)\r\n            }\r\n            if(user.isInitialized===false){\r\n                dispatch(initCategory())\r\n                dispatch(initCompany())\r\n                dispatch(initDayPart())\r\n                dispatch(initExperience())\r\n                dispatch(initStatus())\r\n                dispatch(initLevel())\r\n                dispatch(initViews())\r\n                }\r\n            dispatch(setInitialize())\r\n\r\n    }\r\n    return <>{children}</>\r\n}"],"mappings":";AAAA,SAAoBA,SAAS,QAAQ,OAAO;AAC5C,SAASC,cAAc,QAAQ,gBAAgB;AAE/C,SAASC,UAAU,EAAEC,YAAY,EAAEC,sBAAsB,QAAQ,cAAc;AAC/E,SAASC,aAAa,EAAEC,OAAO,QAAQ,0BAA0B;AACjE,SAASC,YAAY,QAAQ,kCAAkC;AAC/D,SAASC,WAAW,QAAQ,gCAAgC;AAC5D,SAASC,WAAW,QAAQ,gCAAgC;AAC5D,SAASC,cAAc,QAAQ,sCAAsC;AAErE,SAASC,UAAU,QAAQ,8BAA8B;AACzD,SAASC,SAAS,QAAQ,4BAA4B;AACtD,SAASC,SAAS,QAAQ,0BAA0B;AACpD,SAASC,WAAW,QAAQ,aAAa;AACzC,SAASC,UAAU,QAAQ,6BAA6B;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAMxD,eAAe,SAASC,cAAcA,CAAC;EAAEC;AAAgB,CAAC,EAAE;EAAAC,EAAA;EACxD,MAAMC,QAAQ,GAAGtB,cAAc,CAAC,CAAC;EACjC,MAAMuB,IAAI,GAACV,WAAW,CAACC,UAAU,CAAC;EAClCf,SAAS,CAAC,MAAM;IACZyB,cAAc,CAAC,CAAC;EAEpB,CAAC,EAAE,EAAE,CAAC;EACN,eAAeA,cAAcA,CAAA,EAAG;IAC5BC,KAAK,CAAC,cAAc,CAAC;IACrB,MAAMC,QAAyB,GAAG,MAAMzB,UAAU,CAAC,CAAC;IAChD,IAAIyB,QAAQ,aAARA,QAAQ,eAARA,QAAQ,CAAEC,KAAK,IAAIzB,YAAY,CAACwB,QAAQ,CAACC,KAAK,CAAC,EAAE;MACjDL,QAAQ,CAACjB,OAAO,CAACqB,QAAQ,CAACH,IAAI,CAAC,CAAC;MAChCpB,sBAAsB,CAACuB,QAAQ,CAACC,KAAK,CAAC;IAC1C;IACA,IAAGJ,IAAI,CAACK,aAAa,KAAG,KAAK,EAAC;MAC1BN,QAAQ,CAAChB,YAAY,CAAC,CAAC,CAAC;MACxBgB,QAAQ,CAACf,WAAW,CAAC,CAAC,CAAC;MACvBe,QAAQ,CAACd,WAAW,CAAC,CAAC,CAAC;MACvBc,QAAQ,CAACb,cAAc,CAAC,CAAC,CAAC;MAC1Ba,QAAQ,CAACZ,UAAU,CAAC,CAAC,CAAC;MACtBY,QAAQ,CAACX,SAAS,CAAC,CAAC,CAAC;MACrBW,QAAQ,CAACV,SAAS,CAAC,CAAC,CAAC;IACrB;IACJU,QAAQ,CAAClB,aAAa,CAAC,CAAC,CAAC;EAEjC;EACA,oBAAOc,OAAA,CAAAF,SAAA;IAAAI,QAAA,EAAGA;EAAQ,gBAAG,CAAC;AAC1B;AAACC,EAAA,CA3BuBF,cAAc;EAAA,QACjBnB,cAAc,EACpBa,WAAW;AAAA;AAAAgB,EAAA,GAFFV,cAAc;AAAA,IAAAU,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}