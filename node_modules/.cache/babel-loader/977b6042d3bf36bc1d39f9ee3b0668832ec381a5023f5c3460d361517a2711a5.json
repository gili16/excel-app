{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\landa\\\\Documents\\\\\\u05DC\\u05D9\\u05DE\\u05D5\\u05D3\\u05D9\\u05DD\\\\\\u05EA\\u05DB\\u05E0\\u05D5\\u05EA \\u05D9\\u05D3\\\\react\\\\my-final-project\\\\src\\\\pages\\\\TracksPage.tsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport TrackFind from \"../sections/TrackFind.section\";\nimport { useLoaderData } from \"react-router-dom\";\nimport { getTrackByArea, getTrackByText } from \"../services/track\";\nimport { getCompanyById, getDayPartyById, getLevelById, getViewById } from \"../utils/Mapper\";\nimport { useDispatch, useSelector } from \"react-redux\";\n// import { selectAllTracks } from \"../redux/alltracks/alltracks.selector\";\n// import { getAllTracks } from \"../redux/alltracks/alltracks.slice\";\nimport { selectTrack } from \"../redux/track/track.selector\";\nimport { getAllTracks } from \"../redux/track/track.slice\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function TrackPage() {\n  _s();\n  const [desc, setDesc] = useState(undefined);\n  const [filter, setFilter] = useState(undefined);\n  const data = useLoaderData();\n  // const[allTracks,setAllTracks]=useState<Track[]>([])\n  const [descFavIndex, setDecFavIndex] = useState;\n  const allTracks = useSelector(selectTrack);\n  const dispatch = useDispatch();\n  const [lastArea, setLastArea] = useState(\"\");\n  const [tracks, setTracks] = useState([]);\n  useEffect(() => {\n    setTracks(data);\n    dispatch(getAllTracks(data));\n  }, []);\n  useEffect(() => {\n    if (desc !== undefined) {\n      console.log(\"desc\");\n      console.log(desc);\n      loadByDesc();\n    }\n  }, [desc]);\n  useEffect(() => {\n    if (filter !== undefined) {\n      loadByFilter();\n    }\n  }, [filter]);\n  async function loadByDesc() {\n    let temp = await getTrackByText(desc);\n    setTracks([...temp]);\n    setDesc(undefined);\n  }\n  async function loadByFilter() {\n    let temp = [...allTracks];\n    if (lastArea === \"\" || lastArea !== filter.area) {\n      temp = await getTrackByArea(filter.area);\n      setLastArea(filter.area);\n      dispatch(getAllTracks([...temp]));\n    }\n    // setTracks([...temp])\\\n    console.log(\"temp\");\n    console.log(temp);\n    let filtered = [...temp.map(value => {\n      // let flag=/true;\n      if (filter !== undefined && filter !== null) {\n        if (filter.level !== undefined && filter.level !== \"\" && getLevelById(value.levelId) !== filter.level) {\n          return false;\n        }\n        if (filter.dayPart !== undefined && filter.dayPart !== \"\" && getDayPartyById(value.dayPartId) !== filter.dayPart) {\n          return false;\n        }\n        if (filter.company !== undefined && filter.company !== \"\" && getCompanyById(value.companyForTripId) !== filter.company) {\n          return false;\n        }\n        if (filter.view !== undefined && filter.view !== \"\" && getViewById(value.viewId) !== filter.view) {\n          return false;\n        }\n      }\n      return value;\n    })];\n    let filteredTracks = [];\n    for (let i = 0; i < filtered.length; i++) {\n      if (filtered[i]) {\n        filteredTracks.push(temp[i]);\n      }\n    }\n    console.log(\"filteredTracks\");\n    console.log(filteredTracks);\n    console.log(\"filtered\");\n    console.log(filtered);\n    setFilter(undefined);\n    // console.log(tracks)\n    setTracks([...filteredTracks]);\n  }\n  useEffect(() => {\n    console.log(\"tracks\");\n    console.log(tracks);\n  }, [tracks]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(TrackFind, {\n      tracks: tracks,\n      setDesc: setDesc,\n      setFilter: setFilter\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 5\n    }, this)\n  }, void 0, false);\n}\n_s(TrackPage, \"lA9WXxZKE287GC/sM1KZ8HXngKk=\", false, function () {\n  return [useLoaderData, useSelector, useDispatch];\n});\n_c = TrackPage;\nvar _c;\n$RefreshReg$(_c, \"TrackPage\");","map":{"version":3,"names":["useEffect","useState","TrackFind","useLoaderData","getTrackByArea","getTrackByText","getCompanyById","getDayPartyById","getLevelById","getViewById","useDispatch","useSelector","selectTrack","getAllTracks","jsxDEV","_jsxDEV","Fragment","_Fragment","TrackPage","_s","desc","setDesc","undefined","filter","setFilter","data","descFavIndex","setDecFavIndex","allTracks","dispatch","lastArea","setLastArea","tracks","setTracks","console","log","loadByDesc","loadByFilter","temp","area","filtered","map","value","level","levelId","dayPart","dayPartId","company","companyForTripId","view","viewId","filteredTracks","i","length","push","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/landa/Documents/לימודים/תכנות יד/react/my-final-project/src/pages/TracksPage.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport TrackFind from \"../sections/TrackFind.section\";\r\nimport { Filter } from \"../types/Filter.types\";\r\nimport { useLoaderData } from \"react-router-dom\";\r\nimport { Track } from \"../types/Track\";\r\nimport { getTrackByArea, getTrackByText } from \"../services/track\";\r\nimport { getCompanyById, getDayPartyById, getLevelByDescription, getLevelById, getViewById } from \"../utils/Mapper\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n// import { selectAllTracks } from \"../redux/alltracks/alltracks.selector\";\r\n// import { getAllTracks } from \"../redux/alltracks/alltracks.slice\";\r\nimport { selectTrack } from \"../redux/track/track.selector\";\r\nimport { getAllTracks } from \"../redux/track/track.slice\";\r\n\r\nexport default function TrackPage(){\r\n    const [desc,setDesc]=useState<string|undefined>(undefined)\r\n    const[filter,setFilter]=useState<Filter|undefined>(undefined)\r\n    const data:any=useLoaderData()\r\n    // const[allTracks,setAllTracks]=useState<Track[]>([])\r\n    const[descFavIndex,setDecFavIndex]=useState<number|undefined>\r\n    const allTracks=useSelector(selectTrack)\r\n    const dispatch=useDispatch()\r\n    const[lastArea,setLastArea]=useState(\"\")\r\n    const [tracks,setTracks]=useState<Track[]>([])\r\n    useEffect(()=>{\r\n        setTracks(data)\r\n        dispatch(getAllTracks(data))\r\n    },[])\r\n    useEffect(()=>{\r\n        if(desc!==undefined){\r\n            console.log(\"desc\")\r\n            console.log(desc)\r\n            loadByDesc();\r\n        }\r\n    },[desc])\r\n    useEffect(()=>{\r\n        if(filter!==undefined){\r\n            loadByFilter();\r\n        }\r\n    },[filter])\r\n    async function loadByDesc(){\r\n        let temp=await getTrackByText(desc!)\r\n        setTracks([...temp])\r\n        setDesc(undefined)\r\n    }\r\n    async function loadByFilter(){\r\n        let temp=[...allTracks]\r\n        if(lastArea===\"\"||lastArea!==filter!.area){\r\n         temp=await getTrackByArea(filter!.area)\r\n        setLastArea(filter!.area)\r\n        dispatch(getAllTracks([...temp]))\r\n        }\r\n        // setTracks([...temp])\\\r\n        console.log(\"temp\")\r\n        console.log(temp)\r\n        let filtered=[...temp!.map((value:Track)=>{\r\n            // let flag=/true;\r\n            if(filter!==undefined&&filter!==null){\r\n                if(filter.level!==undefined&&filter.level!==\"\"&&getLevelById(value.levelId)!==filter.level){\r\n                    return false;\r\n                }\r\n                if(filter.dayPart!==undefined&&filter.dayPart!==\"\"&&getDayPartyById(value.dayPartId)!==filter.dayPart){\r\n                    return false;\r\n                }\r\n                if(filter.company!==undefined&&filter.company!==\"\"&&getCompanyById(value.companyForTripId)!==filter.company){\r\n                    return false;\r\n                }\r\n                if(filter.view!==undefined&&filter.view!==\"\"&&getViewById(value.viewId)!==filter.view){\r\n                    return false;\r\n                }\r\n            }\r\n            return value;\r\n        })];\r\n        let filteredTracks=[]as Track[]\r\n        for(let i=0;i<filtered.length;i++){\r\n            if(filtered[i]){\r\n                filteredTracks.push(temp[i])\r\n            }\r\n        }\r\n        console.log(\"filteredTracks\")\r\n        console.log(filteredTracks)\r\n        console.log(\"filtered\")\r\n        console.log(filtered)\r\n        setFilter(undefined)\r\n        // console.log(tracks)\r\n        setTracks([...filteredTracks])\r\n    }\r\n    useEffect(()=>{\r\n        console.log(\"tracks\")\r\n        console.log(tracks)\r\n    },[tracks])\r\n    \r\n    return <>\r\n    <TrackFind tracks={tracks} setDesc={setDesc} setFilter={setFilter}/>\r\n    </>\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}