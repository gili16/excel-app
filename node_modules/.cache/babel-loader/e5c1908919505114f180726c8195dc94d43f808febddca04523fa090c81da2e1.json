{"ast":null,"code":"import saveAs from \"file-saver\";\nexport function convertFileToBase64(url) {\n  return fetch(url).then(response => {\n    if (!response.ok) {\n      throw new Error(\"File not found\");\n    }\n    return response.blob(); // Get the file as a Blob\n  }).then(blob => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        // Convert the Blob to Base64\n        const base64String = reader.result;\n        resolve(base64String);\n      };\n      reader.onerror = reject;\n      reader.readAsDataURL(blob); // Read the Blob as a Base64 string\n    });\n  }).catch(error => {\n    console.error(\"Error converting file to Base64:\", error);\n    throw error;\n  });\n}\nexport function downloadBase64File(EXCEL_FILE_BASE64, fileName) {\n  let sliceSize = 1024;\n  let byteCharacters = atob(EXCEL_FILE_BASE64.split(',')[1]); // Remove the data URL prefix\n  let bytesLength = byteCharacters.length;\n  let slicesCount = Math.ceil(bytesLength / sliceSize);\n  let byteArrays = new Array(slicesCount);\n  for (let sliceIndex = 0; sliceIndex < slicesCount; ++sliceIndex) {\n    let begin = sliceIndex * sliceSize;\n    let end = Math.min(begin + sliceSize, bytesLength);\n    let bytes = new Array(end - begin);\n    for (let offset = begin, i = 0; offset < end; ++i, ++offset) {\n      bytes[i] = byteCharacters[offset].charCodeAt(0);\n    }\n    byteArrays[sliceIndex] = new Uint8Array(bytes);\n  }\n\n  // Use FileSaver.js to trigger the file download\n  const blob = new Blob(byteArrays, {\n    type: \"application/vnd.ms-excel.sheet.macroEnabled.12\"\n  });\n  saveAs(blob, `${fileName}.xlsm`); // Save the file with .xlsm extension\n}","map":{"version":3,"names":["saveAs","convertFileToBase64","url","fetch","then","response","ok","Error","blob","Promise","resolve","reject","reader","FileReader","onloadend","base64String","result","onerror","readAsDataURL","catch","error","console","downloadBase64File","EXCEL_FILE_BASE64","fileName","sliceSize","byteCharacters","atob","split","bytesLength","length","slicesCount","Math","ceil","byteArrays","Array","sliceIndex","begin","end","min","bytes","offset","i","charCodeAt","Uint8Array","Blob","type"],"sources":["C:/Users/landa/Documents/עבודה/ExcelStartup/website/web2/src/utils.ts"],"sourcesContent":["import saveAs from \"file-saver\";\r\n\r\nexport function convertFileToBase64(url: string): Promise<string> {\r\n    return fetch(url)\r\n      .then((response) => {\r\n        if (!response.ok) {\r\n          throw new Error(\"File not found\");\r\n        }\r\n        return response.blob(); // Get the file as a Blob\r\n      })\r\n      .then((blob) => {\r\n        return new Promise<string>((resolve, reject) => {\r\n          const reader = new FileReader();\r\n          reader.onloadend = () => {\r\n            // Convert the Blob to Base64\r\n            const base64String = reader.result as string;\r\n            resolve(base64String);\r\n          };\r\n          reader.onerror = reject;\r\n          reader.readAsDataURL(blob); // Read the Blob as a Base64 string\r\n        });\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Error converting file to Base64:\", error);\r\n        throw error;\r\n      });\r\n  }\r\n  export function downloadBase64File(EXCEL_FILE_BASE64: string, fileName: string) {\r\n    let sliceSize = 1024;\r\n    let byteCharacters = atob(EXCEL_FILE_BASE64.split(',')[1]); // Remove the data URL prefix\r\n    let bytesLength = byteCharacters.length;\r\n    let slicesCount = Math.ceil(bytesLength / sliceSize);\r\n    let byteArrays = new Array(slicesCount);\r\n\r\n    for (let sliceIndex = 0; sliceIndex < slicesCount; ++sliceIndex) {\r\n      let begin = sliceIndex * sliceSize;\r\n      let end = Math.min(begin + sliceSize, bytesLength);\r\n      let bytes = new Array(end - begin);\r\n\r\n      for (let offset = begin, i = 0; offset < end; ++i, ++offset) {\r\n        bytes[i] = byteCharacters[offset].charCodeAt(0);\r\n      }\r\n\r\n      byteArrays[sliceIndex] = new Uint8Array(bytes);\r\n    }\r\n\r\n    // Use FileSaver.js to trigger the file download\r\n    const blob = new Blob(byteArrays, { type: \"application/vnd.ms-excel.sheet.macroEnabled.12\" });\r\n    saveAs(blob, `${fileName}.xlsm`);  // Save the file with .xlsm extension\r\n  }"],"mappings":"AAAA,OAAOA,MAAM,MAAM,YAAY;AAE/B,OAAO,SAASC,mBAAmBA,CAACC,GAAW,EAAmB;EAC9D,OAAOC,KAAK,CAACD,GAAG,CAAC,CACdE,IAAI,CAAEC,QAAQ,IAAK;IAClB,IAAI,CAACA,QAAQ,CAACC,EAAE,EAAE;MAChB,MAAM,IAAIC,KAAK,CAAC,gBAAgB,CAAC;IACnC;IACA,OAAOF,QAAQ,CAACG,IAAI,CAAC,CAAC,CAAC,CAAC;EAC1B,CAAC,CAAC,CACDJ,IAAI,CAAEI,IAAI,IAAK;IACd,OAAO,IAAIC,OAAO,CAAS,CAACC,OAAO,EAAEC,MAAM,KAAK;MAC9C,MAAMC,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;MAC/BD,MAAM,CAACE,SAAS,GAAG,MAAM;QACvB;QACA,MAAMC,YAAY,GAAGH,MAAM,CAACI,MAAgB;QAC5CN,OAAO,CAACK,YAAY,CAAC;MACvB,CAAC;MACDH,MAAM,CAACK,OAAO,GAAGN,MAAM;MACvBC,MAAM,CAACM,aAAa,CAACV,IAAI,CAAC,CAAC,CAAC;IAC9B,CAAC,CAAC;EACJ,CAAC,CAAC,CACDW,KAAK,CAAEC,KAAK,IAAK;IAChBC,OAAO,CAACD,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;IACxD,MAAMA,KAAK;EACb,CAAC,CAAC;AACN;AACA,OAAO,SAASE,kBAAkBA,CAACC,iBAAyB,EAAEC,QAAgB,EAAE;EAC9E,IAAIC,SAAS,GAAG,IAAI;EACpB,IAAIC,cAAc,GAAGC,IAAI,CAACJ,iBAAiB,CAACK,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC5D,IAAIC,WAAW,GAAGH,cAAc,CAACI,MAAM;EACvC,IAAIC,WAAW,GAAGC,IAAI,CAACC,IAAI,CAACJ,WAAW,GAAGJ,SAAS,CAAC;EACpD,IAAIS,UAAU,GAAG,IAAIC,KAAK,CAACJ,WAAW,CAAC;EAEvC,KAAK,IAAIK,UAAU,GAAG,CAAC,EAAEA,UAAU,GAAGL,WAAW,EAAE,EAAEK,UAAU,EAAE;IAC/D,IAAIC,KAAK,GAAGD,UAAU,GAAGX,SAAS;IAClC,IAAIa,GAAG,GAAGN,IAAI,CAACO,GAAG,CAACF,KAAK,GAAGZ,SAAS,EAAEI,WAAW,CAAC;IAClD,IAAIW,KAAK,GAAG,IAAIL,KAAK,CAACG,GAAG,GAAGD,KAAK,CAAC;IAElC,KAAK,IAAII,MAAM,GAAGJ,KAAK,EAAEK,CAAC,GAAG,CAAC,EAAED,MAAM,GAAGH,GAAG,EAAE,EAAEI,CAAC,EAAE,EAAED,MAAM,EAAE;MAC3DD,KAAK,CAACE,CAAC,CAAC,GAAGhB,cAAc,CAACe,MAAM,CAAC,CAACE,UAAU,CAAC,CAAC,CAAC;IACjD;IAEAT,UAAU,CAACE,UAAU,CAAC,GAAG,IAAIQ,UAAU,CAACJ,KAAK,CAAC;EAChD;;EAEA;EACA,MAAMhC,IAAI,GAAG,IAAIqC,IAAI,CAACX,UAAU,EAAE;IAAEY,IAAI,EAAE;EAAiD,CAAC,CAAC;EAC7F9C,MAAM,CAACQ,IAAI,EAAG,GAAEgB,QAAS,OAAM,CAAC,CAAC,CAAE;AACrC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}