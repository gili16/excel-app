{"ast":null,"code":"import { addUser as addUserApi, deleteFavorite as deleteFavoriteApi, addFavorite as addFavoriteApi } from '../../services/user';\nimport { addUser as addUserAction, logoutUser as logoutUserAction, setUser } from './user.slice';\nimport { Login as LoginApi, updateUser as updateUserApi } from \"../../services/user\";\nimport { removeSession, setSession } from \"../../auth/auth.utils\";\nimport { updateTrack } from \"../track/track.slice\";\nimport { updateUser as updateUserAction, deleteFavorite as deleteFavoriteAction, addFavorite as addFavoriteAction } from \"./user.slice\";\nexport const addUser = user => async (dispatch, getState) => {\n  // const state = getState()// אם רוצים לקבל מידע מהרידקס כדי לשלוח לקריאת שרת\n  try {\n    const newUser = await addUserApi(user);\n    dispatch(addUserAction(newUser));\n    const response = await LoginApi(newUser.mail);\n    dispatch(setUser(response.user));\n    setSession(response);\n    return newUser;\n  } catch (error) {\n    alert(\"please try another email address\");\n  }\n};\nexport const Login = mail => async (dispatch, getState) => {\n  try {\n    const response = await LoginApi(mail);\n    dispatch(setUser(response.user));\n    setSession(response);\n    return response;\n  } catch (error) {\n    alert(error);\n  }\n  return null;\n};\nexport const logoutUser = user => async (dispatch, getState) => {\n  dispatch(logoutUserAction());\n  removeSession();\n};\nexport const deleteFavourite = (userId, track, token) => async (dispatch, getState) => {\n  await deleteFavoriteApi(userId, track, token);\n  let newTrack = {\n    ...track\n  };\n  newTrack.favourites -= 1;\n  dispatch(updateTrack({\n    ...newTrack\n  }));\n  dispatch(deleteFavoriteAction(track.id));\n};\nexport const addFavorite = (userId, track, token) => async (dispatch, getState) => {\n  await addFavoriteApi(userId, track, token);\n  let newTrack = {\n    ...track\n  };\n  newTrack.favourites += 1;\n  dispatch(updateTrack({\n    ...newTrack\n  }));\n  dispatch(addFavoriteAction(track.id));\n};\nexport const updateUser = (user, userJson, token) => async (dispatch, getState) => {\n  try {\n    const newUser = await updateUserApi(userJson.id, user, token);\n    dispatch(updateUserAction(newUser));\n    return newUser;\n  } catch (error) {\n    alert(\"please try another email address\");\n  }\n};","map":{"version":3,"names":["addUser","addUserApi","deleteFavorite","deleteFavoriteApi","addFavorite","addFavoriteApi","addUserAction","logoutUser","logoutUserAction","setUser","Login","LoginApi","updateUser","updateUserApi","removeSession","setSession","updateTrack","updateUserAction","deleteFavoriteAction","addFavoriteAction","user","dispatch","getState","newUser","response","mail","error","alert","deleteFavourite","userId","track","token","newTrack","favourites","id","userJson"],"sources":["C:/Users/landa/Documents/לימודים/תכנות יד/react/my-final-project/src/redux/user/user.thunk.ts"],"sourcesContent":["import { AuthUser, User } from \"../../types/user.types\";\r\nimport { addUser as addUserApi, deleteFavorite as deleteFavoriteApi, addFavorite as addFavoriteApi, getUser } from '../../services/user'\r\nimport { AppThunk } from \"../store\";\r\nimport { addUser as addUserAction, logoutUser as logoutUserAction, setUser } from './user.slice'\r\nimport { getUserByToken as getUserApi, Login as LoginApi,updateUser as updateUserApi } from \"../../services/user\";\r\nimport { removeSession, setSession } from \"../../auth/auth.utils\";\r\nimport { Track } from \"../../types/Track\";\r\nimport { updateTrack } from \"../track/track.slice\";\r\nimport {updateUser as updateUserAction, deleteFavorite as deleteFavoriteAction, addFavorite as addFavoriteAction, deleteTrack as deleteTrackAction, addTrack as addTrackAction } from \"./user.slice\";\r\nexport const addUser = (user: FormData): AppThunk<User> => async (dispatch, getState) => {\r\n\r\n    // const state = getState()// אם רוצים לקבל מידע מהרידקס כדי לשלוח לקריאת שרת\r\n    try {\r\n        const newUser = await addUserApi(user)\r\n        dispatch(addUserAction(newUser))\r\n        const response = await LoginApi(newUser.mail)\r\n        dispatch(setUser(response.user))\r\n        setSession(response)\r\n        return newUser\r\n    } catch (error) {\r\n\r\n        alert(\"please try another email address\")\r\n    }\r\n}\r\n\r\nexport const Login = (mail: string): AppThunk<AuthUser | null> => async (dispatch, getState) => {\r\n    try {\r\n        const response = await LoginApi(mail)\r\n        dispatch(setUser(response.user))\r\n        setSession(response)\r\n        return response;\r\n    } catch (error) {\r\n        alert(error)\r\n    }\r\n    return null;\r\n\r\n\r\n}\r\n\r\nexport const logoutUser = (user: User | null | undefined): AppThunk<User | void> => async (dispatch, getState) => {\r\n    dispatch(logoutUserAction())\r\n    removeSession();\r\n}\r\n\r\nexport const deleteFavourite = (userId: number, track: Track, token: string): AppThunk<void> => async (dispatch, getState) => {\r\n    await deleteFavoriteApi(userId, track, token)\r\n    let newTrack = { ...track }\r\n    newTrack.favourites -= 1;\r\n    dispatch(updateTrack({ ...newTrack }))\r\n    dispatch(deleteFavoriteAction(track.id))\r\n\r\n}\r\nexport const addFavorite = (userId: number, track: Track, token: string): AppThunk<void> => async (dispatch, getState) => {\r\n    await addFavoriteApi(userId, track, token)\r\n    let newTrack = { ...track }\r\n    newTrack.favourites += 1;\r\n    dispatch(updateTrack({ ...newTrack }))\r\n    dispatch(addFavoriteAction(track.id))\r\n\r\n}\r\n\r\nexport const updateUser=(user: FormData,userJson:User, token:string): AppThunk<User> => async (dispatch, getState) => {\r\n\r\n    try {\r\n        const newUser = await updateUserApi(userJson.id, user,token)\r\n        dispatch(updateUserAction(newUser))\r\n        return newUser\r\n    } catch (error) {\r\n\r\n        alert(\"please try another email address\")\r\n    }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}