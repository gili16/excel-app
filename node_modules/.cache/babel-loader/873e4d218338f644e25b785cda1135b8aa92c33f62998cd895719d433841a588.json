{"ast":null,"code":"import { saveAs } from \"file-saver\"; // Correct TypeScript import for file-saver\nimport * as fs from \"fs\";\nimport * as path from \"path\";\n/**\r\n * Converts a file from a given URL to a Base64-encoded string.\r\n * @param url - The URL of the file to convert.\r\n * @returns A promise that resolves to the Base64-encoded string.\r\n */\nexport function convertFileToBase64(filePath) {\n  return new Promise((resolve, reject) => {\n    const absolutePath = path.resolve(filePath); // Ensure absolute path\n    fs.readFile(absolutePath, (err, data) => {\n      if (err) {\n        reject(`Error reading file: ${err.message}`);\n      } else {\n        const base64String = `data:application/vnd.ms-excel.sheet.macroEnabled.12;base64,${data.toString(\"base64\")}`;\n        resolve(base64String);\n      }\n    });\n  });\n}\n\n/**\r\n * Downloads a file from a Base64-encoded string.\r\n * @param EXCEL_FILE_BASE64 - The Base64-encoded file content.\r\n * @param fileName - The name of the file to save.\r\n */\nexport function downloadBase64File(EXCEL_FILE_BASE64, fileName) {\n  const sliceSize = 1024;\n  console.log(EXCEL_FILE_BASE64);\n  const byteCharacters = atob(EXCEL_FILE_BASE64.split(\",\")[1]); // Remove the data URL prefix\n  const bytesLength = byteCharacters.length;\n  const slicesCount = Math.ceil(bytesLength / sliceSize);\n  const byteArrays = new Array(slicesCount);\n  for (let sliceIndex = 0; sliceIndex < slicesCount; ++sliceIndex) {\n    const begin = sliceIndex * sliceSize;\n    const end = Math.min(begin + sliceSize, bytesLength);\n    const bytes = new Array(end - begin);\n    for (let offset = begin, i = 0; offset < end; ++i, ++offset) {\n      bytes[i] = byteCharacters[offset].charCodeAt(0);\n    }\n    byteArrays[sliceIndex] = new Uint8Array(bytes);\n  }\n\n  // Use FileSaver.js to trigger the file download\n  const blob = new Blob(byteArrays, {\n    type: \"application/vnd.ms-excel.sheet.macroEnabled.12\"\n  });\n  saveAs(blob, `${fileName}.xlsm`); // Save the file with .xlsm extension\n}","map":{"version":3,"names":["saveAs","fs","path","convertFileToBase64","filePath","Promise","resolve","reject","absolutePath","readFile","err","data","message","base64String","toString","downloadBase64File","EXCEL_FILE_BASE64","fileName","sliceSize","console","log","byteCharacters","atob","split","bytesLength","length","slicesCount","Math","ceil","byteArrays","Array","sliceIndex","begin","end","min","bytes","offset","i","charCodeAt","Uint8Array","blob","Blob","type"],"sources":["C:/Users/landa/Documents/עבודה/ExcelStartup/website/web2/src/utils.ts"],"sourcesContent":["import { saveAs } from \"file-saver\"; // Correct TypeScript import for file-saver\r\nimport * as fs from \"fs\";\r\nimport * as path from \"path\";\r\n/**\r\n * Converts a file from a given URL to a Base64-encoded string.\r\n * @param url - The URL of the file to convert.\r\n * @returns A promise that resolves to the Base64-encoded string.\r\n */\r\nexport function convertFileToBase64(filePath: string): Promise<string> {\r\n  return new Promise((resolve, reject) => {\r\n    const absolutePath = path.resolve(filePath); // Ensure absolute path\r\n    fs.readFile(absolutePath, (err, data) => {\r\n      if (err) {\r\n        reject(`Error reading file: ${err.message}`);\r\n      } else {\r\n        const base64String = `data:application/vnd.ms-excel.sheet.macroEnabled.12;base64,${data.toString(\"base64\")}`;\r\n        resolve(base64String);\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Downloads a file from a Base64-encoded string.\r\n * @param EXCEL_FILE_BASE64 - The Base64-encoded file content.\r\n * @param fileName - The name of the file to save.\r\n */\r\nexport function downloadBase64File(EXCEL_FILE_BASE64: string, fileName: string): void {\r\n  const sliceSize = 1024;\r\n  console.log(EXCEL_FILE_BASE64)\r\n  const byteCharacters = atob(EXCEL_FILE_BASE64.split(\",\")[1]); // Remove the data URL prefix\r\n  const bytesLength = byteCharacters.length;\r\n  const slicesCount = Math.ceil(bytesLength / sliceSize);\r\n  const byteArrays = new Array(slicesCount);\r\n\r\n  for (let sliceIndex = 0; sliceIndex < slicesCount; ++sliceIndex) {\r\n    const begin = sliceIndex * sliceSize;\r\n    const end = Math.min(begin + sliceSize, bytesLength);\r\n    const bytes = new Array(end - begin);\r\n\r\n    for (let offset = begin, i = 0; offset < end; ++i, ++offset) {\r\n      bytes[i] = byteCharacters[offset].charCodeAt(0);\r\n    }\r\n\r\n    byteArrays[sliceIndex] = new Uint8Array(bytes);\r\n  }\r\n\r\n  // Use FileSaver.js to trigger the file download\r\n  const blob = new Blob(byteArrays, { type: \"application/vnd.ms-excel.sheet.macroEnabled.12\" });\r\n  saveAs(blob, `${fileName}.xlsm`); // Save the file with .xlsm extension\r\n}\r\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,YAAY,CAAC,CAAC;AACrC,OAAO,KAAKC,EAAE,MAAM,IAAI;AACxB,OAAO,KAAKC,IAAI,MAAM,MAAM;AAC5B;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,mBAAmBA,CAACC,QAAgB,EAAmB;EACrE,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtC,MAAMC,YAAY,GAAGN,IAAI,CAACI,OAAO,CAACF,QAAQ,CAAC,CAAC,CAAC;IAC7CH,EAAE,CAACQ,QAAQ,CAACD,YAAY,EAAE,CAACE,GAAG,EAAEC,IAAI,KAAK;MACvC,IAAID,GAAG,EAAE;QACPH,MAAM,CAAE,uBAAsBG,GAAG,CAACE,OAAQ,EAAC,CAAC;MAC9C,CAAC,MAAM;QACL,MAAMC,YAAY,GAAI,8DAA6DF,IAAI,CAACG,QAAQ,CAAC,QAAQ,CAAE,EAAC;QAC5GR,OAAO,CAACO,YAAY,CAAC;MACvB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASE,kBAAkBA,CAACC,iBAAyB,EAAEC,QAAgB,EAAQ;EACpF,MAAMC,SAAS,GAAG,IAAI;EACtBC,OAAO,CAACC,GAAG,CAACJ,iBAAiB,CAAC;EAC9B,MAAMK,cAAc,GAAGC,IAAI,CAACN,iBAAiB,CAACO,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC9D,MAAMC,WAAW,GAAGH,cAAc,CAACI,MAAM;EACzC,MAAMC,WAAW,GAAGC,IAAI,CAACC,IAAI,CAACJ,WAAW,GAAGN,SAAS,CAAC;EACtD,MAAMW,UAAU,GAAG,IAAIC,KAAK,CAACJ,WAAW,CAAC;EAEzC,KAAK,IAAIK,UAAU,GAAG,CAAC,EAAEA,UAAU,GAAGL,WAAW,EAAE,EAAEK,UAAU,EAAE;IAC/D,MAAMC,KAAK,GAAGD,UAAU,GAAGb,SAAS;IACpC,MAAMe,GAAG,GAAGN,IAAI,CAACO,GAAG,CAACF,KAAK,GAAGd,SAAS,EAAEM,WAAW,CAAC;IACpD,MAAMW,KAAK,GAAG,IAAIL,KAAK,CAACG,GAAG,GAAGD,KAAK,CAAC;IAEpC,KAAK,IAAII,MAAM,GAAGJ,KAAK,EAAEK,CAAC,GAAG,CAAC,EAAED,MAAM,GAAGH,GAAG,EAAE,EAAEI,CAAC,EAAE,EAAED,MAAM,EAAE;MAC3DD,KAAK,CAACE,CAAC,CAAC,GAAGhB,cAAc,CAACe,MAAM,CAAC,CAACE,UAAU,CAAC,CAAC,CAAC;IACjD;IAEAT,UAAU,CAACE,UAAU,CAAC,GAAG,IAAIQ,UAAU,CAACJ,KAAK,CAAC;EAChD;;EAEA;EACA,MAAMK,IAAI,GAAG,IAAIC,IAAI,CAACZ,UAAU,EAAE;IAAEa,IAAI,EAAE;EAAiD,CAAC,CAAC;EAC7F1C,MAAM,CAACwC,IAAI,EAAG,GAAEvB,QAAS,OAAM,CAAC,CAAC,CAAC;AACpC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}