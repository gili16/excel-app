{"ast":null,"code":"import { getSession, isValidToken, removeSession } from \"../auth/auth.utils\";\nimport { ENDPOINTS, baseUrl } from \"../api/endpoints\";\nexport const authRequestMiddleware = async request => {\n  const user = await getSession();\n  alert(\"request to: \" + request.url);\n  console.log();\n  if (request.url !== baseUrl.url + ENDPOINTS.addUser) {\n    if (!user || !isValidToken(user.token)) {\n      removeSession();\n      Promise.reject('Unauthorized');\n    }\n  }\n  return request;\n};\nexport const authResponseMiddleware = response => {\n  if (response.status === 401) {\n    alert(\"response\");\n    removeSession();\n    Promise.reject('Unauthorized');\n  }\n  return response;\n};","map":{"version":3,"names":["getSession","isValidToken","removeSession","ENDPOINTS","baseUrl","authRequestMiddleware","request","user","alert","url","console","log","addUser","token","Promise","reject","authResponseMiddleware","response","status"],"sources":["C:/Users/landa/Documents/לימודים/תכנות יד/react/my-final-project/src/utils/authMiddleware.ts"],"sourcesContent":["import { InternalAxiosRequestConfig, AxiosResponse } from \"axios\";\r\nimport { getSession, isValidToken, removeSession } from \"../auth/auth.utils\"\r\nimport { ENDPOINTS, baseUrl } from \"../api/endpoints\";\r\n\r\nexport const authRequestMiddleware = async (request: InternalAxiosRequestConfig) => {\r\n    const user = await getSession()\r\n    alert(\"request to: \" + request.url);\r\n    console.log()\r\n    if (request.url !== (baseUrl.url + ENDPOINTS.addUser)) {\r\n        if (!user || !isValidToken(user.token)) {\r\n            removeSession();\r\n            Promise.reject('Unauthorized')\r\n        }\r\n    }\r\n    return request\r\n}\r\n\r\nexport const authResponseMiddleware = (response: AxiosResponse) => {\r\n    if (response.status === 401) {\r\n        alert(\"response\")\r\n        removeSession();\r\n        Promise.reject('Unauthorized')\r\n    }\r\n    return response\r\n}"],"mappings":"AACA,SAASA,UAAU,EAAEC,YAAY,EAAEC,aAAa,QAAQ,oBAAoB;AAC5E,SAASC,SAAS,EAAEC,OAAO,QAAQ,kBAAkB;AAErD,OAAO,MAAMC,qBAAqB,GAAG,MAAOC,OAAmC,IAAK;EAChF,MAAMC,IAAI,GAAG,MAAMP,UAAU,CAAC,CAAC;EAC/BQ,KAAK,CAAC,cAAc,GAAGF,OAAO,CAACG,GAAG,CAAC;EACnCC,OAAO,CAACC,GAAG,CAAC,CAAC;EACb,IAAIL,OAAO,CAACG,GAAG,KAAML,OAAO,CAACK,GAAG,GAAGN,SAAS,CAACS,OAAQ,EAAE;IACnD,IAAI,CAACL,IAAI,IAAI,CAACN,YAAY,CAACM,IAAI,CAACM,KAAK,CAAC,EAAE;MACpCX,aAAa,CAAC,CAAC;MACfY,OAAO,CAACC,MAAM,CAAC,cAAc,CAAC;IAClC;EACJ;EACA,OAAOT,OAAO;AAClB,CAAC;AAED,OAAO,MAAMU,sBAAsB,GAAIC,QAAuB,IAAK;EAC/D,IAAIA,QAAQ,CAACC,MAAM,KAAK,GAAG,EAAE;IACzBV,KAAK,CAAC,UAAU,CAAC;IACjBN,aAAa,CAAC,CAAC;IACfY,OAAO,CAACC,MAAM,CAAC,cAAc,CAAC;EAClC;EACA,OAAOE,QAAQ;AACnB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}